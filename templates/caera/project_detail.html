{% extends "base.html" %}

{% block content %}
  <div class="partition">
    {% if project.image %}
      <div class="image_detail">
        <img class="image" src="{{ project.image.url }}" alt="Project image">
      </div>
    {% else %}
    {% endif %}
    <div class="info">
      <h1>
        {{ project.title }}
        <a href="{% url 'caera:project-delete' pk=proposal.id project_pk=project.id %}"
           class="btn btn-danger link-to-page">
          –í–∏–¥–∞–ª–∏—Ç–∏
        </a>

        <a href="{% url 'caera:project-update' pk=proposal.id project_pk=project.id %}"
           class="btn btn-secondary link-to-page">
          –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
        </a>
      </h1>

      <form method="post" action="{% url 'caera:project-like-toggle' pk=proposal.pk project_pk=project.pk %}">
        {% csrf_token %}
        <button type="submit" name="value" value="like"
                class="btn {% if user_like and user_like.value == 'like' %}btn-success{% else %}btn-outline-success{% endif %}">
          üëç ({{ project.like_count }})
        </button>

        <button type="submit" name="value" value="dislike"
                class="btn {% if user_like and user_like.value == 'dislike' %}btn-danger{% else %}btn-outline-danger{% endif %}">
          üëé ({{ project.dislike_count }})
        </button>
      </form>

      <form method="post" action="{% url 'caera:project-paid-reaction-toggle' pk=proposal.pk project_pk=project.pk %}">
        {% csrf_token %}
        <button type="submit"
                class="btn {% if user_paid_reaction %}btn-warning{% else %}btn-outline-warning{% endif %}">
          ‚≠ê ({{ project.paid_reactions.count }})
        </button>
      </form>

    </div>
  </div>

  <div class="proposal-description">
    {{ project.description }}
  </div>

  <div class="reviews">
    <h2 class="review_h2">
      –ö–æ–º–º–µ–Ω—Ç–∞—Ä—ñ

      <a href="{% url 'caera:project-comment-create' pk=proposal.id project_pk=project.id %}" class="btn link-to-page"
         style="color: forestgreen">
        –ö–æ–º–º–µ–Ω—Ç—É–≤–∞—Ç–∏
      </a>
    </h2>

    <hr>
    {% for comment in project.comments.all %}
      <div class="question">
        {{ comment.user.username }}

        <p>
          {{ comment.created_at }}
        </p>

        <p>
          {{ comment.text }}
        </p>

        {% if comment.user == request.user %}
          <div class="d-flex gap-2">
            <a href="{% url 'caera:project-comment-update' pk=proposal.id project_pk=project.id comment_pk=comment.id %}"
               class="btn btn-sm btn-outline-primary">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
            <a href="{% url 'caera:project-comment-delete' pk=proposal.id project_pk=project.id comment_pk=comment.id %}"
               class="btn btn-sm btn-outline-danger">–í–∏–¥–∞–ª–∏—Ç–∏</a>
          </div>
        {% endif %}
      </div>
    {% endfor %}
  </div>
{% endblock %}
